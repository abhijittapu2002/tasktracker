<div class="container-fluid py-4">
  <div class="card shadow-lg">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <h3 class="mb-0 fw-bold"><i class="fas fa-project-diagram me-2"></i>Project Master</h3>
      <button class="btn btn-light" (click)="toggleForm()">
        <i class="fas fa-plus me-2"></i>{{ showForm ? 'Close Form' : 'New Project' }}
      </button>
    </div>

    <div class="card-body">
      <!-- Project Form -->
      <div class="card border-success mt-4" *ngIf="showForm">
        <div class="card-header bg-light-success d-flex justify-content-between align-items-center">
          <h5 class="mb-0">
            <i class="fas fa-pencil-alt me-2"></i>{{ isEditing ? 'Edit Project' : 'New Project' }}
          </h5>
          <div class="badge bg-success">{{ isEditing ? 'Editing Mode' : 'Creation Mode' }}</div>
        </div>
        
        <div class="card-body">
          <form (ngSubmit)="submitProject()">
            <div class="row g-3">
              <div class="col-md-3">
                <label class="form-label small text-muted">Project ID</label>
                <input type="number" class="form-control" 
                       [(ngModel)]="newProject.projId" name="projId" 
                       [readonly]="isEditing" required>
              </div>
              
              <div class="col-md-9">
                <label class="form-label small text-muted">Project Name</label>
                <input type="text" class="form-control" 
                       [(ngModel)]="newProject.projName" name="projName" 
                       required>
              </div>

              <div class="col-12">
                <label class="form-label small text-muted">Description</label>
                <textarea class="form-control" rows="2"
                          [(ngModel)]="newProject.projDesc" name="projDesc"
                          required></textarea>
              </div>

              <div class="col-md-6">
                <label class="form-label small text-muted">Start Date</label>
                <input type="date" class="form-control" 
                       [(ngModel)]="newProject.startDate" name="startDate"
                       required>
              </div>

              <div class="col-md-6">
                <label class="form-label small text-muted">End Date</label>
                <input type="date" class="form-control" 
                       [(ngModel)]="newProject.endDate" name="endDate"
                       required>
              </div>
            </div>

            <div class="mt-4 d-flex justify-content-end gap-2">
              <button type="submit" class="btn btn-success px-4">
                <i class="fas fa-save me-2"></i>{{ isEditing ? 'Update' : 'Create' }}
              </button>
              <button type="button" class="btn btn-outline-secondary" 
                      (click)="cancelEdit()">
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Pagination Controls - Top -->
      <div class="d-flex justify-content-between align-items-center mb-3" *ngIf="projects.length > 0">
        <div class="d-flex align-items-center">
          <span class="me-2 text-muted small">Show</span>
          <select class="form-select form-select-sm" style="width: auto;" [(ngModel)]="pageSize" (change)="onPageSizeChange()">
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="25">25</option>
            <option value="50">50</option>
          </select>
          <span class="ms-2 text-muted small">entries</span>
        </div>
        
        <div class="d-flex align-items-center">
          <span class="text-muted small me-3">
            Showing {{ getStartIndex() }} to 
            {{ getEndIndex() }} of {{ totalItems }} entries
          </span>
          
          <nav>
            <ul class="pagination pagination-sm mb-0">
              <li class="page-item" [class.disabled]="currentPage === 1">
                <button class="page-link" (click)="goToPage(1)" title="First Page">
                  <i class="fas fa-angle-double-left"></i>
                </button>
              </li>
              <li class="page-item" [class.disabled]="currentPage === 1">
                <button class="page-link" (click)="goToPage(currentPage - 1)" title="Previous">
                  <i class="fas fa-angle-left"></i>
                </button>
              </li>
              
              <li class="page-item" *ngFor="let page of getPages()" [class.active]="page === currentPage">
                <button class="page-link" (click)="goToPage(page)">{{ page }}</button>
              </li>
              
              <li class="page-item" [class.disabled]="currentPage === totalPages">
                <button class="page-link" (click)="goToPage(currentPage + 1)" title="Next">
                  <i class="fas fa-angle-right"></i>
                </button>
              </li>
              <li class="page-item" [class.disabled]="currentPage === totalPages">
                <button class="page-link" (click)="goToPage(totalPages)" title="Last Page">
                  <i class="fas fa-angle-double-right"></i>
                </button>
              </li>
            </ul>
          </nav>
        </div>
      </div>

      <!-- Projects Table -->
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-2">
          <thead class="table-light">
            <tr>
              <th class="fw-bold">ID</th>
              <th class="fw-bold">Name</th>
              <th class="fw-bold">Description</th>
              <th class="fw-bold">Start Date</th>
              <th class="fw-bold">End Date</th>
              <th class="fw-bold">Created By</th>
              <th class="fw-bold">Created At</th>
              <th class="fw-bold text-end">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let project of paginatedProjects" (dblclick)="editProject(project)" class="cursor-pointer">
              <td class="text-muted">{{ project.projId }}</td>
              <td class="fw-semibold">{{ project.projName }}</td>
              <td>{{ (project.projDesc || '') | slice:0:25 }}{{ project.projDesc?.length > 25 ? '...' : '' }}</td>
              <td>{{ project.startDate | date: 'mediumDate' }}</td>
              <td>{{ project.endDate | date: 'mediumDate' }}</td>
              <td>{{ project.createdBy }}</td>
              <td>{{ project.createdAt | date: 'short' }}</td>
              <td class="text-end">
                <button class="btn btn-sm btn-outline-danger" 
                        (click)="deleteProject(project.projId)"
                        title="Delete Project">
                  <i class="fas fa-trash-alt fa-xs"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination Controls - Bottom -->
      <div class="d-flex justify-content-between align-items-center mt-3" *ngIf="projects.length > 0">
        <div class="text-muted small">
          Showing {{ getStartIndex() }} to 
          {{ getEndIndex() }} of {{ totalItems }} entries
        </div>
        
        <nav>
          <ul class="pagination pagination-sm mb-0">
            <li class="page-item" [class.disabled]="currentPage === 1">
              <button class="page-link" (click)="goToPage(1)" title="First Page">
                <i class="fas fa-angle-double-left"></i>
              </button>
            </li>
            <li class="page-item" [class.disabled]="currentPage === 1">
              <button class="page-link" (click)="goToPage(currentPage - 1)" title="Previous">
                <i class="fas fa-angle-left"></i>
              </button>
            </li>
            
            <li class="page-item" *ngFor="let page of getPages()" [class.active]="page === currentPage">
              <button class="page-link" (click)="goToPage(page)">{{ page }}</button>
            </li>
            
            <li class="page-item" [class.disabled]="currentPage === totalPages">
              <button class="page-link" (click)="goToPage(currentPage + 1)" title="Next">
                <i class="fas fa-angle-right"></i>
              </button>
            </li>
            <li class="page-item" [class.disabled]="currentPage === totalPages">
              <button class="page-link" (click)="goToPage(totalPages)" title="Last Page">
                <i class="fas fa-angle-double-right"></i>
              </button>
            </li>
          </ul>
        </nav>
      </div>

      <!-- Empty State -->
      <div *ngIf="projects.length === 0" class="text-center py-5 bg-light rounded">
        <i class="fas fa-folder-open fa-3x text-muted mb-3"></i>
        <p class="text-muted">No projects found. Create your first project!</p>
      </div>
    </div>
  </div>
</div>

<style>
  .cursor-pointer { cursor: pointer; }
  .bg-light-success { background-color: #d1e7dd; }
  .table-hover tbody tr:hover { background-color: #f8f9fa; }
  .table th { border-top: none; border-bottom: 2px solid #dee2e6; }
  .table td { border-bottom: 1px solid #f0f0f0; vertical-align: middle; }
  .card { border-radius: 0.75rem; }
  .form-control:focus, .form-select:focus { box-shadow: none; border-color: #86b7fe; }
  .btn-outline-danger:hover { background-color: #dc3545; color: white; }
  .page-item.disabled .page-link { opacity: 0.6; }
</style>